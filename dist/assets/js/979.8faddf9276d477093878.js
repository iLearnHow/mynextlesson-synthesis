"use strict";(self.webpackChunkmynextlesson_synthesis=self.webpackChunkmynextlesson_synthesis||[]).push([[979],{979:function(e,n,t){t.d(n,{SynthesisControls:function(){return o}});var i=t(626),s=t(651),r=t(452);class o{constructor(e){this.engine=e,this.isReady=!1,this.isVisible=!1,this.currentParams=null,this.eventListeners=new Map,this.container=null,this.controls=null,this.ageSlider=null,this.toneSelector=null,this.applyButton=null,this.resetButton=null,this.previewPanel=null}async initialize(){try{i.Vy.info("synthesis_controls_init","Initializing synthesis controls"),this.createControls(),this.setupEventListeners(),this.initializeDefaults(),this.isReady=!0,i.Vy.info("synthesis_controls_ready","Synthesis controls initialized successfully")}catch(e){throw s.zc.handle(e,{context:"synthesis_controls",phase:"initialization"}),e}}createControls(){this.container=document.createElement("div"),this.container.className="synthesis-controls-container",this.container.setAttribute("role","region"),this.container.setAttribute("aria-label","Lesson Customization Controls"),this.controls=document.createElement("div"),this.controls.className="synthesis-controls-panel";const e=this.createHeader(),n=this.createAgeControl(),t=this.createToneControl(),i=this.createActionButtons();this.previewPanel=this.createPreviewPanel(),this.controls.appendChild(e),this.controls.appendChild(n),this.controls.appendChild(t),this.controls.appendChild(i),this.controls.appendChild(this.previewPanel),this.container.appendChild(this.controls);(document.querySelector("#lesson-player")||document.body).appendChild(this.container),this.applyStyles()}createHeader(){const e=document.createElement("div");return e.className="controls-header",e.innerHTML="\n            <h3>Customize Your Lesson</h3>\n            <p>Adjust the lesson to match your learning preferences</p>\n        ",e}createAgeControl(){const e=document.createElement("div");e.className="control-group age-control",this.ageSlider=document.createElement("input"),this.ageSlider.type="range",this.ageSlider.min="5",this.ageSlider.max="65",this.ageSlider.value="25",this.ageSlider.className="age-slider",this.ageSlider.setAttribute("aria-label","Select your age");const n=document.createElement("div");n.className="age-display",n.innerHTML='\n            <span class="age-label">Age:</span>\n            <span class="age-value">25</span>\n            <span class="age-description">Adult learner</span>\n        ';const t=document.createElement("div");return t.className="age-ranges",t.innerHTML='\n            <span class="range-label">Young (5-12)</span>\n            <span class="range-label">Teen (13-17)</span>\n            <span class="range-label">Adult (18-65)</span>\n        ',e.appendChild(n),e.appendChild(this.ageSlider),e.appendChild(t),e}createToneControl(){const e=document.createElement("div");e.className="control-group tone-control",this.toneSelector=document.createElement("div"),this.toneSelector.className="tone-selector",this.toneSelector.setAttribute("role","radiogroup"),this.toneSelector.setAttribute("aria-label","Select lesson tone");[{value:"neutral",label:"Neutral",description:"Professional and balanced",icon:"ðŸŽ¯"},{value:"fun",label:"Fun",description:"Engaging and entertaining",icon:"ðŸŽ‰"},{value:"grandmother",label:"Warm",description:"Nurturing and supportive",icon:"ðŸ’"}].forEach(e=>{const n=document.createElement("div");n.className="tone-option";const t=document.createElement("input");t.type="radio",t.name="tone",t.value=e.value,t.id=`tone-${e.value}`,t.className="tone-radio";const i=document.createElement("label");i.htmlFor=`tone-${e.value}`,i.className="tone-label",i.innerHTML=`\n                <span class="tone-icon">${e.icon}</span>\n                <div class="tone-info">\n                    <span class="tone-name">${e.label}</span>\n                    <span class="tone-desc">${e.description}</span>\n                </div>\n            `,n.appendChild(t),n.appendChild(i),this.toneSelector.appendChild(n)});const n=this.toneSelector.querySelector('input[value="neutral"]');return n&&(n.checked=!0),e.appendChild(this.toneSelector),e}createActionButtons(){const e=document.createElement("div");return e.className="control-actions",this.applyButton=document.createElement("button"),this.applyButton.className="btn btn-primary apply-btn",this.applyButton.textContent="Apply Changes",this.applyButton.setAttribute("aria-label","Apply synthesis changes"),this.resetButton=document.createElement("button"),this.resetButton.className="btn btn-secondary reset-btn",this.resetButton.textContent="Reset to Defaults",this.resetButton.setAttribute("aria-label","Reset to default settings"),e.appendChild(this.applyButton),e.appendChild(this.resetButton),e}createPreviewPanel(){const e=document.createElement("div");return e.className="preview-panel",e.setAttribute("role","region"),e.setAttribute("aria-label","Lesson Preview"),e.innerHTML='\n            <div class="preview-header">\n                <h4>Preview</h4>\n                <button class="preview-toggle" aria-label="Toggle preview panel">\n                    <svg viewBox="0 0 24 24" width="16" height="16">\n                        <path d="M7 10l5 5 5-5z"/>\n                    </svg>\n                </button>\n            </div>\n            <div class="preview-content">\n                <div class="preview-loading">\n                    <div class="loading-spinner"></div>\n                    <p>Generating preview...</p>\n                </div>\n            </div>\n        ',e}applyStyles(){const e=`\n            .synthesis-controls-container {\n                margin-top: 20px;\n                border-top: 1px solid #e2e8f0;\n                padding-top: 20px;\n            }\n            \n            .synthesis-controls-panel {\n                background: #f8fafc;\n                border-radius: 8px;\n                padding: 20px;\n                border: 1px solid #e2e8f0;\n            }\n            \n            .controls-header {\n                margin-bottom: 20px;\n                text-align: center;\n            }\n            \n            .controls-header h3 {\n                margin: 0 0 8px 0;\n                color: ${r.$.get("ui.theme.text")};\n                font-size: 18px;\n                font-weight: 600;\n            }\n            \n            .controls-header p {\n                margin: 0;\n                color: #64748b;\n                font-size: 14px;\n            }\n            \n            .control-group {\n                margin-bottom: 24px;\n            }\n            \n            .control-group:last-child {\n                margin-bottom: 0;\n            }\n            \n            .age-control {\n                text-align: center;\n            }\n            \n            .age-display {\n                margin-bottom: 12px;\n            }\n            \n            .age-label {\n                font-weight: 600;\n                color: ${r.$.get("ui.theme.text")};\n                margin-right: 8px;\n            }\n            \n            .age-value {\n                font-size: 18px;\n                font-weight: 700;\n                color: ${r.$.get("ui.theme.primary")};\n                margin-right: 8px;\n            }\n            \n            .age-description {\n                color: #64748b;\n                font-size: 14px;\n            }\n            \n            .age-slider {\n                width: 100%;\n                height: 6px;\n                background: #e2e8f0;\n                border-radius: 3px;\n                outline: none;\n                margin-bottom: 8px;\n            }\n            \n            .age-slider::-webkit-slider-thumb {\n                appearance: none;\n                width: 20px;\n                height: 20px;\n                background: ${r.$.get("ui.theme.primary")};\n                border-radius: 50%;\n                cursor: pointer;\n                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n            }\n            \n            .age-slider::-moz-range-thumb {\n                width: 20px;\n                height: 20px;\n                background: ${r.$.get("ui.theme.primary")};\n                border-radius: 50%;\n                cursor: pointer;\n                border: none;\n                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n            }\n            \n            .age-ranges {\n                display: flex;\n                justify-content: space-between;\n                font-size: 12px;\n                color: #64748b;\n            }\n            \n            .tone-selector {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n                gap: 12px;\n            }\n            \n            .tone-option {\n                position: relative;\n            }\n            \n            .tone-radio {\n                position: absolute;\n                opacity: 0;\n                pointer-events: none;\n            }\n            \n            .tone-label {\n                display: flex;\n                align-items: center;\n                gap: 12px;\n                padding: 16px;\n                border: 2px solid #e2e8f0;\n                border-radius: 8px;\n                cursor: pointer;\n                transition: all 0.2s ease;\n                background: white;\n            }\n            \n            .tone-label:hover {\n                border-color: ${r.$.get("ui.theme.primary")};\n                background: #f0f9ff;\n            }\n            \n            .tone-radio:checked + .tone-label {\n                border-color: ${r.$.get("ui.theme.primary")};\n                background: #eff6ff;\n                box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n            }\n            \n            .tone-icon {\n                font-size: 24px;\n                width: 32px;\n                text-align: center;\n            }\n            \n            .tone-info {\n                flex: 1;\n            }\n            \n            .tone-name {\n                display: block;\n                font-weight: 600;\n                color: ${r.$.get("ui.theme.text")};\n                margin-bottom: 4px;\n            }\n            \n            .tone-desc {\n                display: block;\n                font-size: 12px;\n                color: #64748b;\n                line-height: 1.3;\n            }\n            \n            .control-actions {\n                display: flex;\n                gap: 12px;\n                justify-content: center;\n                margin-top: 24px;\n            }\n            \n            .btn {\n                padding: 12px 24px;\n                border: none;\n                border-radius: 6px;\n                font-size: 14px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.2s ease;\n                min-width: 120px;\n            }\n            \n            .btn-primary {\n                background: ${r.$.get("ui.theme.primary")};\n                color: white;\n            }\n            \n            .btn-primary:hover {\n                background: ${r.$.get("ui.theme.accent")};\n                transform: translateY(-1px);\n            }\n            \n            .btn-secondary {\n                background: #f1f5f9;\n                color: ${r.$.get("ui.theme.text")};\n                border: 1px solid #e2e8f0;\n            }\n            \n            .btn-secondary:hover {\n                background: #e2e8f0;\n            }\n            \n            .btn:disabled {\n                opacity: 0.5;\n                cursor: not-allowed;\n                transform: none;\n            }\n            \n            .preview-panel {\n                margin-top: 20px;\n                border: 1px solid #e2e8f0;\n                border-radius: 8px;\n                overflow: hidden;\n            }\n            \n            .preview-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 12px 16px;\n                background: #f8fafc;\n                border-bottom: 1px solid #e2e8f0;\n            }\n            \n            .preview-header h4 {\n                margin: 0;\n                font-size: 14px;\n                font-weight: 600;\n                color: ${r.$.get("ui.theme.text")};\n            }\n            \n            .preview-toggle {\n                background: none;\n                border: none;\n                cursor: pointer;\n                padding: 4px;\n                border-radius: 4px;\n                transition: background-color 0.2s ease;\n            }\n            \n            .preview-toggle:hover {\n                background: #e2e8f0;\n            }\n            \n            .preview-toggle svg {\n                fill: #64748b;\n                transition: transform 0.2s ease;\n            }\n            \n            .preview-toggle.expanded svg {\n                transform: rotate(180deg);\n            }\n            \n            .preview-content {\n                padding: 16px;\n                background: white;\n                max-height: 200px;\n                overflow-y: auto;\n            }\n            \n            .preview-loading {\n                text-align: center;\n                padding: 20px;\n            }\n            \n            .preview-loading .loading-spinner {\n                width: 24px;\n                height: 24px;\n                border: 2px solid #e2e8f0;\n                border-top: 2px solid ${r.$.get("ui.theme.primary")};\n                border-radius: 50%;\n                animation: spin 1s linear infinite;\n                margin: 0 auto 12px;\n            }\n            \n            .preview-loading p {\n                margin: 0;\n                color: #64748b;\n                font-size: 14px;\n            }\n            \n            .preview-text {\n                font-size: 14px;\n                line-height: 1.5;\n                color: ${r.$.get("ui.theme.text")};\n            }\n            \n            .preview-meta {\n                margin-top: 12px;\n                padding-top: 12px;\n                border-top: 1px solid #e2e8f0;\n                font-size: 12px;\n                color: #64748b;\n            }\n            \n            @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n            }\n            \n            @media (max-width: 768px) {\n                .synthesis-controls-panel {\n                    padding: 16px;\n                }\n                \n                .tone-selector {\n                    grid-template-columns: 1fr;\n                }\n                \n                .control-actions {\n                    flex-direction: column;\n                }\n                \n                .btn {\n                    width: 100%;\n                }\n            }\n        `;if(!document.getElementById("synthesis-controls-styles")){const n=document.createElement("style");n.id="synthesis-controls-styles",n.textContent=e,document.head.appendChild(n)}}setupEventListeners(){this.ageSlider.addEventListener("input",e=>{this.updateAgeDisplay(e.target.value),this.schedulePreview()}),this.toneSelector.addEventListener("change",()=>{this.schedulePreview()}),this.applyButton.addEventListener("click",()=>{this.applyChanges()}),this.resetButton.addEventListener("click",()=>{this.resetToDefaults()});const e=this.previewPanel.querySelector(".preview-toggle");e.addEventListener("click",()=>{this.togglePreview()}),this.eventListeners.set("ageSlider",this.ageSlider),this.eventListeners.set("toneSelector",this.toneSelector),this.eventListeners.set("applyButton",this.applyButton),this.eventListeners.set("resetButton",this.resetButton),this.eventListeners.set("previewToggle",e)}initializeDefaults(){const e="neutral";this.ageSlider.value=25,this.updateAgeDisplay(25);const n=this.toneSelector.querySelector(`input[value="${e}"]`);n&&(n.checked=!0),this.currentParams={age:25,tone:e},i.Vy.info("synthesis_controls_defaults",`Defaults set: age=25, tone=${e}`)}updateAgeDisplay(e){const n=this.container.querySelector(".age-value"),t=this.container.querySelector(".age-description");n.textContent=e;let i="";i=e>=5&&e<=12?"Young learner":e>=13&&e<=17?"Teen learner":"Adult learner",t.textContent=i}getCurrentParams(){return{age:parseInt(this.ageSlider.value),tone:this.toneSelector.querySelector("input:checked").value}}schedulePreview(){this.previewTimeout&&clearTimeout(this.previewTimeout),this.previewTimeout=setTimeout(()=>{this.generatePreview()},500)}async generatePreview(){try{const e=this.getCurrentParams(),n=this.previewPanel.querySelector(".preview-content");n.innerHTML='\n                <div class="preview-loading">\n                    <div class="loading-spinner"></div>\n                    <p>Generating preview...</p>\n                </div>\n            ';const t=await this.engine.generatePreview(e);n.innerHTML=`\n                <div class="preview-text">${this.escapeHtml(t.text)}</div>\n                <div class="preview-meta">\n                    Age: ${e.age} | Tone: ${e.tone} | Generated in ${t.duration}ms\n                </div>\n            `,i.Vy.info("synthesis_controls_preview",`Preview generated for age=${e.age}, tone=${e.tone}`)}catch(e){s.zc.handle(e,{context:"synthesis_controls",phase:"preview_generation"});this.previewPanel.querySelector(".preview-content").innerHTML='\n                <div class="preview-error">\n                    <p>Unable to generate preview. Please try again.</p>\n                </div>\n            '}}async applyChanges(){try{const e=this.getCurrentParams();this.applyButton.disabled=!0,this.applyButton.textContent="Applying...";const n=new CustomEvent("synthesis:parametersChanged",{detail:{params:e}});window.dispatchEvent(n),this.currentParams=e,this.applyButton.disabled=!1,this.applyButton.textContent="Apply Changes",i.Vy.info("synthesis_controls_applied",`Changes applied: age=${e.age}, tone=${e.tone}`)}catch(e){s.zc.handle(e,{context:"synthesis_controls",phase:"apply_changes"}),this.applyButton.disabled=!1,this.applyButton.textContent="Apply Changes"}}resetToDefaults(){const e="neutral";this.ageSlider.value=25,this.updateAgeDisplay(25);const n=this.toneSelector.querySelector(`input[value="${e}"]`);n&&(n.checked=!0),this.currentParams={age:25,tone:e},this.schedulePreview(),i.Vy.info("synthesis_controls_reset","Controls reset to defaults")}togglePreview(){const e=this.previewPanel.querySelector(".preview-content"),n=this.previewPanel.querySelector(".preview-toggle");"none"===e.style.display?(e.style.display="block",n.classList.add("expanded")):(e.style.display="none",n.classList.remove("expanded"))}setParameters(e,n){if(e<5||e>65)throw new Error("Age must be between 5 and 65");if(!["neutral","fun","grandmother"].includes(n))throw new Error("Invalid tone specified");this.ageSlider.value=e,this.updateAgeDisplay(e);const t=this.toneSelector.querySelector(`input[value="${n}"]`);t&&(t.checked=!0),this.currentParams={age:e,tone:n},this.schedulePreview(),i.Vy.info("synthesis_controls_set",`Parameters set: age=${e}, tone=${n}`)}escapeHtml(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}show(){this.isVisible=!0,this.container.style.display="block"}hide(){this.isVisible=!1,this.container.style.display="none"}toggle(){this.isVisible?this.hide():this.show()}getStatus(){return{isReady:this.isReady,isVisible:this.isVisible,currentParams:this.currentParams,previewTimeout:!!this.previewTimeout}}async shutdown(){i.Vy.info("synthesis_controls_shutdown","Shutting down synthesis controls"),this.previewTimeout&&clearTimeout(this.previewTimeout),this.eventListeners.forEach((e,n)=>{if(e&&e.removeEventListener)switch(n){case"ageSlider":e.removeEventListener("input",()=>this.updateAgeDisplay());break;case"toneSelector":e.removeEventListener("change",()=>this.schedulePreview());break;case"applyButton":e.removeEventListener("click",()=>this.applyChanges());break;case"resetButton":e.removeEventListener("click",()=>this.resetToDefaults())}}),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.isReady=!1,i.Vy.info("synthesis_controls_shutdown_complete","Synthesis controls shutdown complete")}}}}]);