"use strict";(self.webpackChunkmynextlesson_synthesis=self.webpackChunkmynextlesson_synthesis||[]).push([[610],{610:function(e,t,i){i.d(t,{Accessibility:function(){return a}});var n=i(626),s=i(651),o=i(452);class a{constructor(){this.isReady=!1,this.isEnabled=!0,this.features=new Map,this.eventListeners=new Map,this.observers=new Map,this.settings={highContrast:!1,reducedMotion:!1,screenReader:!1,keyboardNavigation:!0,focusVisible:!0,fontSize:"medium",colorBlindness:"none"}}async initialize(){try{n.Vy.info("accessibility_init","Initializing accessibility features"),this.loadUserPreferences(),await this.initializeFeatures(),this.setupEventListeners(),this.applySettings(),this.isReady=!0,n.Vy.info("accessibility_ready","Accessibility features initialized successfully")}catch(e){throw s.zc.handle(e,{context:"accessibility",phase:"initialization"}),e}}loadUserPreferences(){try{const e=localStorage.getItem("ilearn_accessibility");if(e){const t=JSON.parse(e);this.settings={...this.settings,...t},n.Vy.info("accessibility_preferences_loaded","User preferences loaded")}}catch(e){n.Vy.warn("accessibility_preferences_failed","Failed to load preferences, using defaults")}}async initializeFeatures(){this.features.set("keyboard",this.initializeKeyboardNavigation()),this.features.set("focus",this.initializeFocusManagement()),this.features.set("screenReader",this.initializeScreenReaderSupport()),this.features.set("highContrast",this.initializeHighContrast()),this.features.set("reducedMotion",this.initializeReducedMotion()),this.features.set("fontSize",this.initializeFontSizeControls()),this.features.set("colorBlindness",this.initializeColorBlindnessSupport()),n.Vy.info("accessibility_features_ready","All accessibility features initialized")}initializeKeyboardNavigation(){return{enable:()=>this.enableKeyboardNavigation(),disable:()=>this.disableKeyboardNavigation(),isEnabled:()=>this.settings.keyboardNavigation}}initializeFocusManagement(){return{enable:()=>this.enableFocusManagement(),disable:()=>this.disableFocusManagement(),isEnabled:()=>this.settings.focusVisible}}initializeScreenReaderSupport(){return{enable:()=>this.enableScreenReaderSupport(),disable:()=>this.disableScreenReaderSupport(),isEnabled:()=>this.settings.screenReader}}initializeHighContrast(){return{enable:()=>this.enableHighContrast(),disable:()=>this.disableHighContrast(),isEnabled:()=>this.settings.highContrast}}initializeReducedMotion(){return{enable:()=>this.enableReducedMotion(),disable:()=>this.disableReducedMotion(),isEnabled:()=>this.settings.reducedMotion}}initializeFontSizeControls(){return{setSize:e=>this.setFontSize(e),getSize:()=>this.settings.fontSize,increase:()=>this.increaseFontSize(),decrease:()=>this.decreaseFontSize()}}initializeColorBlindnessSupport(){return{setMode:e=>this.setColorBlindnessMode(e),getMode:()=>this.settings.colorBlindness,isEnabled:()=>"none"!==this.settings.colorBlindness}}setupEventListeners(){document.addEventListener("keydown",e=>this.handleKeyboardShortcuts(e)),document.addEventListener("focusin",e=>this.handleFocusIn(e)),document.addEventListener("focusout",e=>this.handleFocusOut(e)),this.setupScreenReaderAnnouncements(),this.setupMotionPreferenceObserver(),this.eventListeners.set("keydown",document),this.eventListeners.set("focusin",document),this.eventListeners.set("focusout",document)}handleKeyboardShortcuts(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(e.altKey&&"a"===e.key&&(e.preventDefault(),this.toggleAccessibilityPanel()),e.altKey&&"h"===e.key&&(e.preventDefault(),this.toggleHighContrast()),e.altKey&&"m"===e.key&&(e.preventDefault(),this.toggleReducedMotion()),e.altKey&&"+"===e.key&&(e.preventDefault(),this.increaseFontSize()),e.altKey&&"-"===e.key&&(e.preventDefault(),this.decreaseFontSize()),e.altKey&&"0"===e.key&&(e.preventDefault(),this.setFontSize("medium")))}handleFocusIn(e){this.settings.focusVisible&&e.target.classList.add("focus-visible")}handleFocusOut(e){e.target.classList.remove("focus-visible")}setupScreenReaderAnnouncements(){const e=document.createElement("div");e.id="accessibility-live-region",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.className="sr-only",document.body.appendChild(e),this.liveRegion=e}setupMotionPreferenceObserver(){if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=e=>{e.matches&&this.enableReducedMotion()};e.addEventListener("change",t),e.matches&&this.enableReducedMotion(),this.observers.set("motion",e)}}enableKeyboardNavigation(){this.settings.keyboardNavigation=!0,this.applySettings(),this.announce("Keyboard navigation enabled"),n.Vy.info("accessibility_keyboard_enabled","Keyboard navigation enabled")}disableKeyboardNavigation(){this.settings.keyboardNavigation=!1,this.applySettings(),this.announce("Keyboard navigation disabled"),n.Vy.info("accessibility_keyboard_disabled","Keyboard navigation disabled")}enableFocusManagement(){this.settings.focusVisible=!0,this.applySettings(),this.announce("Focus indicators enabled"),n.Vy.info("accessibility_focus_enabled","Focus management enabled")}disableFocusManagement(){this.settings.focusVisible=!1,this.applySettings(),this.announce("Focus indicators disabled"),n.Vy.info("accessibility_focus_disabled","Focus management disabled")}enableScreenReaderSupport(){this.settings.screenReader=!0,this.applySettings(),this.announce("Screen reader support enabled"),n.Vy.info("accessibility_screen_reader_enabled","Screen reader support enabled")}disableScreenReaderSupport(){this.settings.screenReader=!1,this.applySettings(),this.announce("Screen reader support disabled"),n.Vy.info("accessibility_screen_reader_disabled","Screen reader support disabled")}enableHighContrast(){this.settings.highContrast=!0,this.applySettings(),this.announce("High contrast mode enabled"),n.Vy.info("accessibility_high_contrast_enabled","High contrast mode enabled")}disableHighContrast(){this.settings.highContrast=!1,this.applySettings(),this.announce("High contrast mode disabled"),n.Vy.info("accessibility_high_contrast_disabled","High contrast mode disabled")}enableReducedMotion(){this.settings.reducedMotion=!0,this.applySettings(),this.announce("Reduced motion enabled"),n.Vy.info("accessibility_reduced_motion_enabled","Reduced motion enabled")}disableReducedMotion(){this.settings.reducedMotion=!1,this.applySettings(),this.announce("Reduced motion disabled"),n.Vy.info("accessibility_reduced_motion_disabled","Reduced motion disabled")}setFontSize(e){if(!["small","medium","large","x-large"].includes(e))throw new Error(`Invalid font size: ${e}`);this.settings.fontSize=e,this.applySettings(),this.announce(`Font size set to ${e}`),n.Vy.info("accessibility_font_size_set",`Font size set to ${e}`)}increaseFontSize(){const e=["small","medium","large","x-large"],t=e.indexOf(this.settings.fontSize);t<e.length-1&&this.setFontSize(e[t+1])}decreaseFontSize(){const e=["small","medium","large","x-large"],t=e.indexOf(this.settings.fontSize);t>0&&this.setFontSize(e[t-1])}setColorBlindnessMode(e){if(!["none","protanopia","deuteranopia","tritanopia"].includes(e))throw new Error(`Invalid color blindness mode: ${e}`);this.settings.colorBlindness=e,this.applySettings(),this.announce(`Color blindness mode set to ${e}`),n.Vy.info("accessibility_color_blindness_set",`Color blindness mode set to ${e}`)}applySettings(){this.settings.highContrast?document.documentElement.classList.add("high-contrast"):document.documentElement.classList.remove("high-contrast"),this.settings.reducedMotion?document.documentElement.classList.add("reduced-motion"):document.documentElement.classList.remove("reduced-motion"),document.documentElement.classList.remove("font-small","font-medium","font-large","font-x-large"),document.documentElement.classList.add(`font-${this.settings.fontSize}`),document.documentElement.classList.remove("color-protanopia","color-deuteranopia","color-tritanopia"),"none"!==this.settings.colorBlindness&&document.documentElement.classList.add(`color-${this.settings.colorBlindness}`),this.settings.focusVisible?document.documentElement.classList.add("focus-visible-enabled"):document.documentElement.classList.remove("focus-visible-enabled"),this.saveUserPreferences(),this.applyAccessibilityStyles()}applyAccessibilityStyles(){const e=`\n            /* Screen reader only content */\n            .sr-only {\n                position: absolute;\n                width: 1px;\n                height: 1px;\n                padding: 0;\n                margin: -1px;\n                overflow: hidden;\n                clip: rect(0, 0, 0, 0);\n                white-space: nowrap;\n                border: 0;\n            }\n            \n            /* Focus visible styles */\n            .focus-visible-enabled *:focus {\n                outline: 2px solid ${o.$.get("ui.theme.primary")};\n                outline-offset: 2px;\n            }\n            \n            .focus-visible-enabled *:focus:not(:focus-visible) {\n                outline: none;\n            }\n            \n            .focus-visible-enabled *:focus-visible {\n                outline: 2px solid ${o.$.get("ui.theme.primary")};\n                outline-offset: 2px;\n            }\n            \n            /* High contrast mode */\n            .high-contrast {\n                --primary-color: #000000;\n                --secondary-color: #ffffff;\n                --text-color: #000000;\n                --background-color: #ffffff;\n                --border-color: #000000;\n            }\n            \n            .high-contrast * {\n                background-color: var(--background-color) !important;\n                color: var(--text-color) !important;\n                border-color: var(--border-color) !important;\n            }\n            \n            .high-contrast button,\n            .high-contrast input,\n            .high-contrast select {\n                border: 2px solid var(--border-color) !important;\n            }\n            \n            /* Reduced motion */\n            .reduced-motion *,\n            .reduced-motion *::before,\n            .reduced-motion *::after {\n                animation-duration: 0.01ms !important;\n                animation-iteration-count: 1 !important;\n                transition-duration: 0.01ms !important;\n                scroll-behavior: auto !important;\n            }\n            \n            /* Font size controls */\n            .font-small {\n                font-size: 14px;\n            }\n            \n            .font-medium {\n                font-size: 16px;\n            }\n            \n            .font-large {\n                font-size: 18px;\n            }\n            \n            .font-x-large {\n                font-size: 20px;\n            }\n            \n            /* Color blindness support */\n            .color-protanopia {\n                filter: url('#protanopia-filter');\n            }\n            \n            .color-deuteranopia {\n                filter: url('#deuteranopia-filter');\n            }\n            \n            .color-tritanopia {\n                filter: url('#tritanopia-filter');\n            }\n            \n            /* Skip link */\n            .skip-link {\n                position: absolute;\n                top: -40px;\n                left: 6px;\n                background: ${o.$.get("ui.theme.primary")};\n                color: white;\n                padding: 8px;\n                text-decoration: none;\n                border-radius: 4px;\n                z-index: 1000;\n            }\n            \n            .skip-link:focus {\n                top: 6px;\n            }\n            \n            /* ARIA live regions */\n            [aria-live="polite"] {\n                position: absolute;\n                left: -10000px;\n                width: 1px;\n                height: 1px;\n                overflow: hidden;\n            }\n            \n            /* Focus management */\n            .focus-trap {\n                outline: none;\n            }\n            \n            /* Keyboard navigation indicators */\n            .keyboard-nav *:focus {\n                box-shadow: 0 0 0 2px ${o.$.get("ui.theme.primary")};\n            }\n        `;if(!document.getElementById("accessibility-styles")){const t=document.createElement("style");t.id="accessibility-styles",t.textContent=e,document.head.appendChild(t)}}announce(e){this.liveRegion&&(this.liveRegion.textContent=e,setTimeout(()=>{this.liveRegion.textContent=""},1e3)),n.Vy.info("accessibility_announcement",e)}toggleAccessibilityPanel(){this.announce("Accessibility panel toggled"),n.Vy.info("accessibility_panel_toggle","Accessibility panel toggled")}toggleHighContrast(){this.settings.highContrast?this.disableHighContrast():this.enableHighContrast()}toggleReducedMotion(){this.settings.reducedMotion?this.disableReducedMotion():this.enableReducedMotion()}saveUserPreferences(){try{localStorage.setItem("ilearn_accessibility",JSON.stringify(this.settings))}catch(e){n.Vy.warn("accessibility_save_failed","Failed to save accessibility preferences")}}getStatus(){return{isReady:this.isReady,isEnabled:this.isEnabled,settings:{...this.settings},features:Array.from(this.features.keys())}}validateWCAGCompliance(){const e=[],t=document.querySelectorAll("h1, h2, h3, h4, h5, h6");let i=0;t.forEach(t=>{const n=parseInt(t.tagName.charAt(1));n>i+1&&e.push(`Heading level skipped: ${t.tagName} after h${i}`),i=n});document.querySelectorAll("img").forEach(t=>{t.alt||t.getAttribute("aria-label")||e.push(`Image missing alt text: ${t.src}`)});document.querySelectorAll("input, select, textarea").forEach(t=>{t.id&&document.querySelector(`label[for="${t.id}"]`)||e.push(`Form control missing label: ${t.type||t.tagName}`)});return document.querySelectorAll("p, span, div, h1, h2, h3, h4, h5, h6").forEach(t=>{const i=window.getComputedStyle(t);i.color===i.backgroundColor&&e.push(`Potential contrast issue: ${t.tagName}`)}),{compliant:0===e.length,issues:e,score:Math.max(0,100-10*e.length)}}async shutdown(){n.Vy.info("accessibility_shutdown","Shutting down accessibility features"),this.eventListeners.forEach((e,t)=>{e&&e.removeEventListener&&e.removeEventListener(t,this[`handle${t.charAt(0).toUpperCase()+t.slice(1)}`])}),this.observers.forEach((e,t)=>{e&&e.removeEventListener&&e.removeEventListener("change",this[`handle${t.charAt(0).toUpperCase()+t.slice(1)}Change`])}),this.liveRegion&&this.liveRegion.parentNode&&this.liveRegion.parentNode.removeChild(this.liveRegion),this.applySettings(),this.isReady=!1,n.Vy.info("accessibility_shutdown_complete","Accessibility features shutdown complete")}}}}]);